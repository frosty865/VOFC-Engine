import os
from supabase import create_client
from dotenv import load_dotenv

load_dotenv("../../.env")
SUPABASE_URL = os.getenv("SUPABASE_URL") or "https://wivohgbuuwxoyfyzntsd.supabase.co"
SUPABASE_KEY = os.getenv("SUPABASE_SERVICE_ROLE_KEY") or "sb_secret_o6CXg_vuAGMAvnnsfgNDqw_9ZQoQyUk"
supabase = create_client(SUPABASE_URL, SUPABASE_KEY)

# Check all vulnerabilities
vulns = supabase.table('vulnerabilities').select('*').execute()
print(f'Total vulnerabilities: {len(vulns.data)}')

# Look for ISAC-related vulnerabilities
isac_vulns = []
for vuln in vulns.data:
    if 'isac' in vuln['vulnerability'].lower():
        isac_vulns.append(vuln)

print(f'ISAC vulnerabilities found: {len(isac_vulns)}')
for i, vuln in enumerate(isac_vulns):
    print(f'{i+1}. {vuln["vulnerability"][:100]}...')

# Look for any vulnerability that mentions information sharing
info_sharing_vulns = []
for vuln in vulns.data:
    if 'information' in vuln['vulnerability'].lower() and 'sharing' in vuln['vulnerability'].lower():
        info_sharing_vulns.append(vuln)

print(f'\nInformation sharing vulnerabilities: {len(info_sharing_vulns)}')
for i, vuln in enumerate(info_sharing_vulns[:3]):
    print(f'{i+1}. {vuln["vulnerability"][:100]}...')

# Check categories
categories = set(vuln['category'] for vuln in vulns.data)
print(f'\nCategories found: {categories}')
